<!-- Genealogy Pedigree Chart - TRMNL Template -->

<div class="view view--full">
  <div class="layout layout--col" style="padding: 16px; justify-content: flex-start; position: relative;">

    <!-- GRANDPARENTS ROW -->
    <div style="display: flex; justify-content: center; gap: 40px;">

      <!-- Subject's Parents (left couple) -->
      <div style="display: flex; gap: 8px;">
        <div class="pedigree-box">
          <div class="pedigree-name">{{ subject_parents.father.name }}</div>
          <div class="pedigree-dates">{{ subject_parents.father.birth }}-{{ subject_parents.father.death | default: "?" }}</div>
        </div>
        <div class="pedigree-box">
          <div class="pedigree-name">{{ subject_parents.mother.name }}</div>
          <div class="pedigree-dates">{{ subject_parents.mother.birth }}-{{ subject_parents.mother.death | default: "?" }}</div>
        </div>
      </div>

      <!-- Spouse's Parents (right couple) -->
      <div style="display: flex; gap: 8px;">
        <div class="pedigree-box">
          <div class="pedigree-name">{{ spouse_parents.father.name }}</div>
          <div class="pedigree-dates">{{ spouse_parents.father.birth }}-{{ spouse_parents.father.death | default: "?" }}</div>
        </div>
        <div class="pedigree-box">
          <div class="pedigree-name">{{ spouse_parents.mother.name }}</div>
          <div class="pedigree-dates">{{ spouse_parents.mother.birth }}-{{ spouse_parents.mother.death | default: "?" }}</div>
        </div>
      </div>

    </div>

    <!-- CONNECTOR LINES (brackets from grandparents to main row) -->
    <!-- SVG height=94, so 50% = y=47 for the horizontal bracket line -->
    <svg width="100%" height="94" style="display: block; margin-top: -10px; margin-bottom: -43px;">
      <!-- Left bracket: subject's parents -> subject -->
      <path d="M 133,0 L 133,47 L 206,47" stroke="black" fill="none" stroke-width="1"/>
      <path d="M 278,0 L 278,47 L 206,47 L 206,47 L 278,47 L 278,94" stroke="black" fill="none" stroke-width="1"/>

      <!-- Right bracket: spouse's parents -> spouse -->
      <path d="M 455,0 L 455,47 L 528,47" stroke="black" fill="none" stroke-width="1"/>
      <path d="M 600,0 L 600,47 L 528,47 L 528,47 L 455,47 L 455,94" stroke="black" fill="none" stroke-width="1"/>
    </svg>

    <!-- MAIN ROW (Photo - Subject - Spouse - Photo) -->
    <div style="display: flex; justify-content: center; align-items: center; gap: 40px;">
      <div class="pedigree-box">
        <div class="pedigree-name">{{ subject.name }}</div>
        <div class="pedigree-dates">{{ subject.birth }}-{{ subject.death | default: "?" }}</div>
      </div>
      <div class="pedigree-box">
        <div class="pedigree-name">{{ spouse.name }}</div>
        <div class="pedigree-dates">{{ spouse.birth }}-{{ spouse.death | default: "?" }}</div>
      </div>
    </div>

    <!-- PHOTOS - positioned at device edges -->
    {% if subject.photo_url %}
      <div class="photo-frame photo-left">
        <img src="{{ subject.photo_url }}" class="photo"/>
      </div>
    {% endif %}
    {% if spouse.photo_url %}
      <div class="photo-frame photo-right">
        <img src="{{ spouse.photo_url }}" class="photo"/>
      </div>
    {% endif %}

    <!-- CHILDREN SECTION -->
    {% if children.size > 15 %}
      <!-- 2-column layout for many children (>15) - children only, no spouses -->
      <div class="children-section children-section--two-column">
        {% for entry in children %}
          {% if entry.first.child %}
            <div class="child-entry"><strong>{{ entry.first.name }}</strong> ({{ entry.first.birth }}-{{ entry.first.death | default: "?" }})</div>
          {% endif %}
          {% if entry.second.child %}
            <div class="child-entry"><strong>{{ entry.second.name }}</strong> ({{ entry.second.birth }}-{{ entry.second.death | default: "?" }})</div>
          {% endif %}
        {% endfor %}
      </div>
    {% else %}
      <!-- Single column layout with spouses (â‰¤15 children) -->
      <div class="children-section">
        {% for entry in children %}
          <div class="child-entry">
            {% if entry.first.child %}<strong>{{ entry.first.name }}</strong>{% else %}{{ entry.first.name }}{% endif %} ({{ entry.first.birth }}-{{ entry.first.death | default: "?" }}){% if entry.second %} m. {% if entry.second.child %}<strong>{{ entry.second.name }}</strong>{% else %}{{ entry.second.name }}{% endif %} ({{ entry.second.birth }}-{{ entry.second.death | default: "?" }}){% endif %}
          </div>
        {% endfor %}
      </div>
    {% endif %}

  </div>
</div>

<style>
  .pedigree-box {
    border: 1px solid black;
    padding: 4px 6px;
    text-align: center;
    background: white;
    width: 140px;
  }

  .pedigree-name {
    font-weight: 600;
    font-size: 11px;
  }

  .pedigree-dates {
    font-size: 10px;
  }

  .photo-frame {
    position: absolute;
    width: 180px;
    height: 210px;
    display: flex;
    align-items: center;
    justify-content: center;
    top: 130px;
  }

  .photo-left {
    left: 0;
  }

  .photo-right {
    right: 0;
  }

  .photo {
    width: 100%;
    height: 100%;
    object-fit: contain;
    object-position: center;
  }

  .children-section {
    margin-top: 12px;
    padding: 0 180px;
    font-size: 10px;
    line-height: 1.4;
  }

  .children-section--two-column {
    display: grid;
    grid-template-columns: 1fr 1fr;
    column-gap: 20px;
    grid-auto-flow: row;
  }

  .child-entry {
    margin-bottom: 2px;
  }
</style>
